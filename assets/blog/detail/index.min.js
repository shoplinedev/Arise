"use strict";

(self["webpackChunkArise"] = self["webpackChunkArise"] || []).push([ [ "blogDetail" ], {
    "./src/assets/stage/blog/detail/index.js": (__unused_webpack_module, __unused_webpack___webpack_exports__, __webpack_require__) => {
        __webpack_require__("./node_modules/regenerator-runtime/runtime.js");
        __webpack_require__("./node_modules/core-js/modules/es.array.from.js");
        __webpack_require__("./node_modules/core-js/modules/es.string.iterator.js");
        __webpack_require__("./node_modules/core-js/modules/es.object.to-string.js");
        __webpack_require__("./node_modules/core-js/modules/es.promise.js");
        __webpack_require__("./node_modules/core-js/modules/es.array.for-each.js");
        __webpack_require__("./node_modules/core-js/modules/web.dom-collections.for-each.js");
        __webpack_require__("./node_modules/core-js/modules/es.array.slice.js");
        __webpack_require__("./node_modules/core-js/modules/es.array.iterator.js");
        __webpack_require__("./node_modules/core-js/modules/web.dom-collections.iterator.js");
        __webpack_require__("./node_modules/core-js/modules/web.url.js");
        __webpack_require__("./node_modules/core-js/modules/es.regexp.exec.js");
        __webpack_require__("./node_modules/core-js/modules/es.string.search.js");
        __webpack_require__("./node_modules/core-js/modules/es.array.concat.js");
        __webpack_require__("./node_modules/core-js/modules/es.date.to-string.js");
        __webpack_require__("./node_modules/core-js/modules/es.regexp.to-string.js");
        __webpack_require__("./node_modules/core-js/modules/es.object.define-property.js");
        __webpack_require__("./node_modules/core-js/modules/es.object.keys.js");
        __webpack_require__("./node_modules/core-js/modules/es.symbol.js");
        __webpack_require__("./node_modules/core-js/modules/es.array.filter.js");
        __webpack_require__("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");
        __webpack_require__("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js");
        __webpack_require__("./node_modules/core-js/modules/es.object.define-properties.js");
        var i18n = __webpack_require__("../shared/browser/utils/i18n.js");
        var utils_form = __webpack_require__("../shared/browser/utils/form/index.js");
        var emailReg = __webpack_require__("../shared/browser/utils/emailReg.js");
        var request = __webpack_require__("../shared/browser/utils/request.js");
        var toast = __webpack_require__("./src/assets/commons/components/toast/index.js");
        __webpack_require__("./node_modules/core-js/modules/web.timers.js");
        (function() {
            window.SL_EventBus.emit("global:hdReport:exit", [ "60090006" ]);
            window.setInterval((function() {
                var _window$HdSdk;
                null === (_window$HdSdk = window.HdSdk) || void 0 === _window$HdSdk ? void 0 : _window$HdSdk.shopTracker.report(60090006, {
                    page: 124,
                    event_name: 141
                });
            }), 5 * 1e3);
        })();
        function ownKeys(object, enumerableOnly) {
            var keys = Object.keys(object);
            if (Object.getOwnPropertySymbols) {
                var symbols = Object.getOwnPropertySymbols(object);
                if (enumerableOnly) symbols = symbols.filter((function(sym) {
                    return Object.getOwnPropertyDescriptor(object, sym).enumerable;
                }));
                keys.push.apply(keys, symbols);
            }
            return keys;
        }
        function _objectSpread(target) {
            for (var i = 1; i < arguments.length; i++) {
                var source = null != arguments[i] ? arguments[i] : {};
                if (i % 2) ownKeys(Object(source), true).forEach((function(key) {
                    _defineProperty(target, key, source[key]);
                })); else if (Object.getOwnPropertyDescriptors) Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); else ownKeys(Object(source)).forEach((function(key) {
                    Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
                }));
            }
            return target;
        }
        function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {
            try {
                var info = gen[key](arg);
                var value = info.value;
            } catch (error) {
                reject(error);
                return;
            }
            if (info.done) resolve(value); else Promise.resolve(value).then(_next, _throw);
        }
        function _asyncToGenerator(fn) {
            return function() {
                var self = this, args = arguments;
                return new Promise((function(resolve, reject) {
                    var gen = fn.apply(self, args);
                    function _next(value) {
                        asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value);
                    }
                    function _throw(err) {
                        asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err);
                    }
                    _next(void 0);
                }));
            };
        }
        function _classCallCheck(instance, Constructor) {
            if (!(instance instanceof Constructor)) throw new TypeError("Cannot call a class as a function");
        }
        function _defineProperties(target, props) {
            for (var i = 0; i < props.length; i++) {
                var descriptor = props[i];
                descriptor.enumerable = descriptor.enumerable || false;
                descriptor.configurable = true;
                if ("value" in descriptor) descriptor.writable = true;
                Object.defineProperty(target, descriptor.key, descriptor);
            }
        }
        function _createClass(Constructor, protoProps, staticProps) {
            if (protoProps) _defineProperties(Constructor.prototype, protoProps);
            if (staticProps) _defineProperties(Constructor, staticProps);
            return Constructor;
        }
        function _defineProperty(obj, key, value) {
            if (key in obj) Object.defineProperty(obj, key, {
                value,
                enumerable: true,
                configurable: true,
                writable: true
            }); else obj[key] = value;
            return obj;
        }
        var SEND_API = "/site/render/blogComment/addBlogComment";
        var detail_toast = new toast["default"]({
            content: "content",
            className: "blog-form__toast",
            duration: 5e3
        });
        var fields = [ {
            name: "author",
            rules: [ {
                message: (0, i18n.t)("blog.comment.name_empty"),
                required: true
            } ]
        }, {
            name: "email",
            value: "",
            rules: [ {
                message: (0, i18n.t)("blog.comment.email_empty"),
                required: true
            }, {
                message: (0, i18n.t)("blog.comment.email_format"),
                pattern: emailReg.EMAIL_VALID_REGEXP
            } ]
        }, {
            name: "content",
            value: "",
            rules: [ {
                message: (0, i18n.t)("blog.comment.comment_empty"),
                required: true
            } ]
        } ];
        var BlogDetail = function() {
            function BlogDetail() {
                _classCallCheck(this, BlogDetail);
                _defineProperty(this, "commentForm", null);
                _defineProperty(this, "submitBtn", null);
                this.initLoadMore();
                this.submitBtn = Array.from(document.getElementsByClassName("blog__form-submit")).pop();
                if (!this.submitBtn) return;
                this.initSubmitBtn();
                this.commentForm = utils_form["default"].takeForm("blog-comment-form");
                this.commentForm.init();
                this.commentForm.setFields(fields);
            }
            _createClass(BlogDetail, [ {
                key: "validateForm",
                value: function() {
                    var _this = this;
                    return new Promise((function(resolve, reject) {
                        _this.commentForm.validateFields().then((function(res) {
                            if (res.pass) resolve(); else reject(res);
                        }));
                    }));
                }
            }, {
                key: "initSubmitBtn",
                value: function() {
                    var _this2 = this;
                    this.submitBtn.onclick = function() {
                        var _ref = _asyncToGenerator(regeneratorRuntime.mark((function _callee(event) {
                            var contactData, _yield$request$post, data, commentConfig;
                            return regeneratorRuntime.wrap((function(_context) {
                                while (1) switch (_context.prev = _context.next) {
                                  case 0:
                                    event.preventDefault();
                                    _context.next = 3;
                                    return _this2.validateForm();

                                  case 3:
                                    contactData = _this2.commentForm.getFieldsValue();
                                    console.log(contactData);
                                    _context.prev = 5;
                                    _context.next = 8;
                                    return request["default"].post(SEND_API, _objectSpread(_objectSpread({}, contactData), {}, {
                                        blogId: _this2.commentForm.el.dataset.blogId
                                    }));

                                  case 8:
                                    _yield$request$post = _context.sent;
                                    data = _yield$request$post.data;
                                    commentConfig = +_this2.commentForm.el.dataset.commentConfig;
                                    if (1 === commentConfig) detail_toast.open((0, i18n.t)("blog.comment.submit_audit_tip")); else detail_toast.open((0, 
                                    i18n.t)("blog.comment.success"));
                                    _this2.commentForm.setFields(fields);
                                    redirectBlogComment(data.id);
                                    _context.next = 19;
                                    break;

                                  case 16:
                                    _context.prev = 16;
                                    _context.t0 = _context["catch"](5);
                                    detail_toast.open("Network Error");

                                  case 19:
                                  case "end":
                                    return _context.stop();
                                }
                            }), _callee, null, [ [ 5, 16 ] ]);
                        })));
                        return function(_x) {
                            return _ref.apply(this, arguments);
                        };
                    }();
                }
            }, {
                key: "initLoadMore",
                value: function() {
                    var loadMore = Array.from(document.getElementsByClassName("blog__comments-loadmore")).pop();
                    if (!loadMore) return;
                    var loadMoreBtn = Array.from(loadMore.getElementsByClassName("blog__comments-loadmore-btn")).pop();
                    if (!loadMoreBtn) return;
                    var commentList = Array.from(document.getElementsByClassName("blog__comments-list")).pop();
                    if (!commentList) return;
                    var limit = +commentList.dataset.blockLimit;
                    Array.from(commentList.children).slice(limit).forEach((function(item) {
                        item.style.display = "none";
                    }));
                    loadMoreBtn.onclick = function() {
                        loadMore.style.display = "none";
                        Array.from(commentList.children).slice(limit).forEach((function(item) {
                            item.style.display = "";
                        }));
                    };
                }
            } ]);
            return BlogDetail;
        }();
        _defineProperty(BlogDetail, "type", "blog-detail");
        function redirectBlogComment(commentId) {
            var url = new URL(window.location.href);
            var query = new URLSearchParams(window.location.search);
            var old = query.get("comment");
            if (old) query.set("comment", "".concat(old, ",").concat(commentId)); else query.set("comment", commentId);
            window.location.href = "".concat(url.origin + url.pathname, "?").concat(query.toString());
        }
        new BlogDetail;
    },
    "../shared/browser/utils/emailReg.js": (__unused_webpack_module, __webpack_exports__, __webpack_require__) => {
        __webpack_require__.d(__webpack_exports__, {
            EMAIL_VALID_REGEXP: () => EMAIL_VALID_REGEXP
        });
        var EMAIL_VALID_REGEXP = /^[0-9a-zA-Z\+]+[0-9a-zA-Z\.\-\+\_]*[0-9a-zA-Z\+]+@[0-9a-zA-Z\u4e00-\u9fa5]+(\-?[0-9a-zA-Z\u4e00-\u9fa5]+)*(\.[0-9a-zA-Z\u4e00-\u9fa5]+)+$|^[0-9a-zA-Z\+]+[0-9a-zA-Z\.\-\+\_]*[0-9a-zA-Z\+]+@[0-9a-zA-Z\u4e00-\u9fa5]+(\-?[0-9a-zA-Z\u4e00-\u9fa5]+)*(\.[0-9a-zA-Z\u4e00-\u9fa5]+\-[0-9a-zA-Z\u4e00-\u9fa5]+)+$|^[0-9a-zA-Z\+]+[0-9a-zA-Z\.\-\+\_]*[0-9a-zA-Z\+]+@[0-9a-zA-Z\u4e00-\u9fa5]+(\-?[0-9a-zA-Z\u4e00-\u9fa5]+)*(\.[0-9a-zA-Z\u4e00-\u9fa5]+(\-[0-9a-zA-Z\u4e00-\u9fa5]+)*)+$|^[0-9a-zA-Z\+]+@[0-9a-zA-Z\u4e00-\u9fa5]+(\-?[0-9a-zA-Z\u4e00-\u9fa5]+)*(\.[0-9a-zA-Z\u4e00-\u9fa5]+)+$|^[0-9a-zA-Z\+]+@[0-9a-zA-Z\u4e00-\u9fa5]+(\-?[0-9a-zA-Z\u4e00-\u9fa5]+)*(\.[0-9a-zA-Z\u4e00-\u9fa5]+\-[0-9a-zA-Z\u4e00-\u9fa5]+)+$|^[0-9a-zA-Z\+]+@[0-9a-zA-Z\u4e00-\u9fa5]+(\-?[0-9a-zA-Z\u4e00-\u9fa5]+)*(\.[0-9a-zA-Z\u4e00-\u9fa5]+(\-[0-9a-zA-Z\u4e00-\u9fa5]+)*)+$/;
    }
}, __webpack_require__ => {
    var __webpack_exec__ = moduleId => __webpack_require__(__webpack_require__.s = moduleId);
    __webpack_require__.O(0, [ "vendor" ], (() => __webpack_exec__("./src/assets/stage/blog/detail/index.js")));
    __webpack_require__.O();
} ]);