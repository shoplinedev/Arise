"use strict";

(self["webpackChunkArise"] = self["webpackChunkArise"] || []).push([ [ "product-search" ], {
    "./src/assets/product/search/main.js": (__unused_webpack_module, __unused_webpack___webpack_exports__, __webpack_require__) => {
        __webpack_require__("./node_modules/core-js/modules/es.array.for-each.js");
        __webpack_require__("./node_modules/core-js/modules/web.dom-collections.for-each.js");
        __webpack_require__("./node_modules/core-js/modules/es.object.define-property.js");
        __webpack_require__("./node_modules/core-js/modules/es.object.keys.js");
        __webpack_require__("./node_modules/core-js/modules/es.symbol.js");
        __webpack_require__("./node_modules/core-js/modules/es.array.filter.js");
        __webpack_require__("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");
        __webpack_require__("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js");
        __webpack_require__("./node_modules/core-js/modules/es.object.define-properties.js");
        var state_selector = __webpack_require__("../shared/browser/utils/state-selector.js");
        __webpack_require__("../shared/browser/node_modules/core-js/modules/es.array.map.js");
        __webpack_require__("../shared/browser/node_modules/core-js/modules/es.object.set-prototype-of.js");
        __webpack_require__("../shared/browser/node_modules/core-js/modules/es.object.get-prototype-of.js");
        __webpack_require__("../shared/browser/node_modules/core-js/modules/es.reflect.construct.js");
        __webpack_require__("../shared/browser/node_modules/core-js/modules/es.object.create.js");
        __webpack_require__("../shared/browser/node_modules/core-js/modules/es.reflect.get.js");
        __webpack_require__("../shared/browser/node_modules/core-js/modules/es.object.get-own-property-descriptor.js");
        __webpack_require__("../shared/browser/node_modules/core-js/modules/es.object.define-property.js");
        __webpack_require__("../shared/browser/node_modules/core-js/modules/es.object.keys.js");
        __webpack_require__("../shared/browser/node_modules/core-js/modules/es.symbol.js");
        __webpack_require__("../shared/browser/node_modules/core-js/modules/es.array.filter.js");
        __webpack_require__("../shared/browser/node_modules/core-js/modules/es.array.for-each.js");
        __webpack_require__("../shared/browser/node_modules/core-js/modules/web.dom-collections.for-each.js");
        __webpack_require__("../shared/browser/node_modules/core-js/modules/es.object.get-own-property-descriptors.js");
        __webpack_require__("../shared/browser/node_modules/core-js/modules/es.object.define-properties.js");
        __webpack_require__("../shared/browser/node_modules/core-js/modules/es.symbol.description.js");
        __webpack_require__("../shared/browser/node_modules/core-js/modules/es.object.to-string.js");
        __webpack_require__("../shared/browser/node_modules/core-js/modules/es.symbol.iterator.js");
        __webpack_require__("../shared/browser/node_modules/core-js/modules/es.array.iterator.js");
        __webpack_require__("../shared/browser/node_modules/core-js/modules/es.string.iterator.js");
        __webpack_require__("../shared/browser/node_modules/core-js/modules/web.dom-collections.iterator.js");
        var currency = __webpack_require__("../shared/browser/utils/currency/index.js");
        var utils = __webpack_require__("../shared/browser/report/product/utils/index.js");
        var baseReport = __webpack_require__("../shared/browser/report/common/baseReport.js");
        function _typeof(obj) {
            "@babel/helpers - typeof";
            if ("function" === typeof Symbol && "symbol" === typeof Symbol.iterator) _typeof = function(obj) {
                return typeof obj;
            }; else _typeof = function(obj) {
                return obj && "function" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
            };
            return _typeof(obj);
        }
        function ownKeys(object, enumerableOnly) {
            var keys = Object.keys(object);
            if (Object.getOwnPropertySymbols) {
                var symbols = Object.getOwnPropertySymbols(object);
                if (enumerableOnly) symbols = symbols.filter((function(sym) {
                    return Object.getOwnPropertyDescriptor(object, sym).enumerable;
                }));
                keys.push.apply(keys, symbols);
            }
            return keys;
        }
        function _objectSpread(target) {
            for (var i = 1; i < arguments.length; i++) {
                var source = null != arguments[i] ? arguments[i] : {};
                if (i % 2) ownKeys(Object(source), true).forEach((function(key) {
                    _defineProperty(target, key, source[key]);
                })); else if (Object.getOwnPropertyDescriptors) Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); else ownKeys(Object(source)).forEach((function(key) {
                    Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
                }));
            }
            return target;
        }
        function _defineProperty(obj, key, value) {
            if (key in obj) Object.defineProperty(obj, key, {
                value,
                enumerable: true,
                configurable: true,
                writable: true
            }); else obj[key] = value;
            return obj;
        }
        function _classCallCheck(instance, Constructor) {
            if (!(instance instanceof Constructor)) throw new TypeError("Cannot call a class as a function");
        }
        function _defineProperties(target, props) {
            for (var i = 0; i < props.length; i++) {
                var descriptor = props[i];
                descriptor.enumerable = descriptor.enumerable || false;
                descriptor.configurable = true;
                if ("value" in descriptor) descriptor.writable = true;
                Object.defineProperty(target, descriptor.key, descriptor);
            }
        }
        function _createClass(Constructor, protoProps, staticProps) {
            if (protoProps) _defineProperties(Constructor.prototype, protoProps);
            if (staticProps) _defineProperties(Constructor, staticProps);
            return Constructor;
        }
        function _get(target, property, receiver) {
            if ("undefined" !== typeof Reflect && Reflect.get) _get = Reflect.get; else _get = function(target, property, receiver) {
                var base = _superPropBase(target, property);
                if (!base) return;
                var desc = Object.getOwnPropertyDescriptor(base, property);
                if (desc.get) return desc.get.call(receiver);
                return desc.value;
            };
            return _get(target, property, receiver || target);
        }
        function _superPropBase(object, property) {
            while (!Object.prototype.hasOwnProperty.call(object, property)) {
                object = _getPrototypeOf(object);
                if (null === object) break;
            }
            return object;
        }
        function _inherits(subClass, superClass) {
            if ("function" !== typeof superClass && null !== superClass) throw new TypeError("Super expression must either be null or a function");
            subClass.prototype = Object.create(superClass && superClass.prototype, {
                constructor: {
                    value: subClass,
                    writable: true,
                    configurable: true
                }
            });
            if (superClass) _setPrototypeOf(subClass, superClass);
        }
        function _setPrototypeOf(o, p) {
            _setPrototypeOf = Object.setPrototypeOf || function(o, p) {
                o.__proto__ = p;
                return o;
            };
            return _setPrototypeOf(o, p);
        }
        function _createSuper(Derived) {
            var hasNativeReflectConstruct = _isNativeReflectConstruct();
            return function() {
                var result, Super = _getPrototypeOf(Derived);
                if (hasNativeReflectConstruct) {
                    var NewTarget = _getPrototypeOf(this).constructor;
                    result = Reflect.construct(Super, arguments, NewTarget);
                } else result = Super.apply(this, arguments);
                return _possibleConstructorReturn(this, result);
            };
        }
        function _possibleConstructorReturn(self, call) {
            if (call && ("object" === _typeof(call) || "function" === typeof call)) return call;
            return _assertThisInitialized(self);
        }
        function _assertThisInitialized(self) {
            if (void 0 === self) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
            return self;
        }
        function _isNativeReflectConstruct() {
            if ("undefined" === typeof Reflect || !Reflect.construct) return false;
            if (Reflect.construct.sham) return false;
            if ("function" === typeof Proxy) return true;
            try {
                Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() {})));
                return true;
            } catch (e) {
                return false;
            }
        }
        function _getPrototypeOf(o) {
            _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function(o) {
                return o.__proto__ || Object.getPrototypeOf(o);
            };
            return _getPrototypeOf(o);
        }
        var formatCurrency = currency["default"].formatCurrency;
        var SearchItemReport = function(_BaseReport) {
            _inherits(SearchItemReport, _BaseReport);
            var _super = _createSuper(SearchItemReport);
            function SearchItemReport() {
                _classCallCheck(this, SearchItemReport);
                return _super.apply(this, arguments);
            }
            _createClass(SearchItemReport, [ {
                key: "searchResults",
                value: function(reportData) {
                    (0, utils.validParams)(reportData);
                    var _reportData$baseParam = reportData.baseParams, baseParams = void 0 === _reportData$baseParam ? {} : _reportData$baseParam, productInfo = reportData.productInfo;
                    var search_string = productInfo.search_string, productList = productInfo.productList;
                    var productsInfoParams = {
                        search_string,
                        items: productList.map((function(_ref, index) {
                            var reportSkuId = _ref.reportSkuId, spuSeq = _ref.spuSeq, productMinPrice = _ref.productMinPrice;
                            return {
                                sku_id: reportSkuId,
                                spu_id: spuSeq,
                                position: index + 1,
                                price: formatCurrency(productMinPrice),
                                quantity: 1
                            };
                        }))
                    };
                    _get(_getPrototypeOf(SearchItemReport.prototype), "searchResults", this).call(this, {
                        baseParams,
                        customParams: productsInfoParams
                    });
                }
            }, {
                key: "itemSelect",
                value: function(reportData) {
                    (0, utils.validParams)(reportData);
                    var _reportData$baseParam2 = reportData.baseParams, baseParams = void 0 === _reportData$baseParam2 ? {} : _reportData$baseParam2, productInfo = reportData.productInfo, _reportData$extInfo = reportData.extInfo, extInfo = void 0 === _reportData$extInfo ? {} : _reportData$extInfo;
                    var id = productInfo.id, skuId = productInfo.skuId, status = productInfo.status, price = productInfo.price, index = productInfo.index;
                    var productInfoParams = {
                        spu_id: id,
                        sku_id: skuId,
                        price: formatCurrency(price),
                        position: index + 1,
                        status: status ? 102 : 101
                    };
                    var params = _objectSpread(_objectSpread({}, productInfoParams), extInfo);
                    _get(_getPrototypeOf(SearchItemReport.prototype), "selectContent", this).call(this, {
                        baseParams,
                        customParams: params
                    });
                }
            } ]);
            return SearchItemReport;
        }(baseReport.BaseReport);
        var product_item = __webpack_require__("../shared/browser/report/product/product-item.js");
        __webpack_require__("./node_modules/core-js/modules/es.array.slice.js");
        var report = __webpack_require__("../shared/browser/utils/report/index.js");
        var noop = function() {};
        function reportEvent(eventId) {
            var _window$HdSdk;
            var params = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};
            if (!eventId) throw new Error("eventId must be provided!");
            null === (_window$HdSdk = window.HdSdk) || void 0 === _window$HdSdk ? void 0 : _window$HdSdk.shopTracker.report(eventId, params);
        }
        function getReportMethods(eventId) {
            if (!eventId) throw new Error("eventId must be provided!");
            var exposeApis = {};
            exposeApis.exitPageExposure = function() {
                var exitParams = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : null;
                window.SL_EventBus.emit("global:hdReport:exit", [ eventId, exitParams ]);
            };
            exposeApis.event = function() {
                var params = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                reportEvent(eventId, params);
            };
            exposeApis.exposure = function(selector) {
                var callback = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : noop;
                if (!selector || "string" !== typeof selector) throw new TypeError("selector is must be a string");
                window.SL_EventBus.on("global:hdReport:expose", (function(target) {
                    if (null !== target && void 0 !== target && target.classList.contains(selector.slice(1))) callback(target);
                }));
                (0, report.collectObserver)({
                    selector
                });
            };
            return exposeApis;
        }
        var BaseClass = __webpack_require__("./src/assets/commons/base/BaseClass.js");
        function report_ownKeys(object, enumerableOnly) {
            var keys = Object.keys(object);
            if (Object.getOwnPropertySymbols) {
                var symbols = Object.getOwnPropertySymbols(object);
                if (enumerableOnly) symbols = symbols.filter((function(sym) {
                    return Object.getOwnPropertyDescriptor(object, sym).enumerable;
                }));
                keys.push.apply(keys, symbols);
            }
            return keys;
        }
        function report_objectSpread(target) {
            for (var i = 1; i < arguments.length; i++) {
                var source = null != arguments[i] ? arguments[i] : {};
                if (i % 2) report_ownKeys(Object(source), true).forEach((function(key) {
                    report_defineProperty(target, key, source[key]);
                })); else if (Object.getOwnPropertyDescriptors) Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); else report_ownKeys(Object(source)).forEach((function(key) {
                    Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
                }));
            }
            return target;
        }
        function report_defineProperty(obj, key, value) {
            if (key in obj) Object.defineProperty(obj, key, {
                value,
                enumerable: true,
                configurable: true,
                writable: true
            }); else obj[key] = value;
            return obj;
        }
        var base = new BaseClass["default"]("product:search:report");
        var productItemSelector = ".__sl-custom-track-product-item-search";
        var hdReport = new SearchItemReport;
        var hdItemReport = new product_item["default"];
        function startReport() {
            var _getReportMethods = getReportMethods("60006259"), exitPageExposure = _getReportMethods.exitPageExposure, exposure = _getReportMethods.exposure, event = _getReportMethods.event;
            exitPageExposure();
            bindEventReport(event);
            exposure(productItemSelector, (function(target) {
                var $el = __SL_$__(target);
                var id = $el.data("id");
                var status = $el.data("status") ? "soldout" : "selling";
                var index = $el.data("index");
                var productPrice = $el.data("price");
                var productName = $el.data("name");
                event({
                    event_name: "product_view",
                    product_id: id,
                    product_name: productName,
                    product_price: productPrice,
                    position: index + 1,
                    status
                });
            }));
            searchHdReport();
        }
        function searchHdReport() {
            var _SL_State$get, _SL_State$get2, _SL_State$get3;
            var productList = null !== (_SL_State$get = state_selector.SL_State.get("products.list")) && void 0 !== _SL_State$get ? _SL_State$get : null;
            var searchRequest = null !== (_SL_State$get2 = state_selector.SL_State.get("request")) && void 0 !== _SL_State$get2 ? _SL_State$get2 : null;
            var productSortation = null !== (_SL_State$get3 = state_selector.SL_State.get("productSortation")) && void 0 !== _SL_State$get3 ? _SL_State$get3 : null;
            var productInfo = {
                search_string: searchRequest.uri.query.keyword,
                productList,
                productSortation
            };
            hdReport.searchResults({
                productInfo
            });
            productList.forEach((function(product, index) {
                hdItemReport.itemView({
                    baseParams: {
                        module: 109,
                        component: 101,
                        action_type: 101
                    },
                    productInfo: report_objectSpread(report_objectSpread({}, product), {}, {
                        index
                    }),
                    extInfo: {
                        search_string: searchRequest.uri.query.keyword
                    }
                });
            }));
        }
        function bindEventReport(event) {
            var _SL_State$get4;
            var searchRequest = null !== (_SL_State$get4 = state_selector.SL_State.get("request")) && void 0 !== _SL_State$get4 ? _SL_State$get4 : null;
            base.$on("click", productItemSelector, (function(_ref) {
                var currentTarget = _ref.currentTarget;
                var id = __SL_$__(currentTarget).data("id");
                event({
                    product_id: id,
                    event_name: "click_product"
                });
                hdReport.itemSelect({
                    productInfo: __SL_$__(currentTarget).data(),
                    extInfo: {
                        search_string: searchRequest.uri.query.keyword
                    }
                });
            }));
        }
        startReport();
        __webpack_require__("./src/assets/product/commons/js/product-item.js");
        __webpack_require__("./node_modules/core-js/modules/es.array.iterator.js");
        __webpack_require__("./node_modules/core-js/modules/es.object.to-string.js");
        __webpack_require__("./node_modules/core-js/modules/es.string.iterator.js");
        __webpack_require__("./node_modules/core-js/modules/web.dom-collections.iterator.js");
        __webpack_require__("./node_modules/core-js/modules/web.url.js");
        __webpack_require__("./node_modules/core-js/modules/es.array.concat.js");
        __webpack_require__("./node_modules/core-js/modules/es.date.to-string.js");
        __webpack_require__("./node_modules/core-js/modules/es.regexp.to-string.js");
        __webpack_require__("./node_modules/core-js/modules/es.array.find.js");
        __webpack_require__("./node_modules/core-js/modules/es.string.trim.js");
        __webpack_require__("./node_modules/core-js/modules/es.array.is-array.js");
        __webpack_require__("./node_modules/core-js/modules/es.array.reduce.js");
        function gen(name, mods) {
            if (!mods) return "";
            if ("string" === typeof mods) return " ".concat(name, "--").concat(mods);
            if (Array.isArray(mods)) return mods.reduce((function(ret, item) {
                return ret + gen(name, item);
            }), "");
            return Object.keys(mods).reduce((function(ret, key) {
                return ret + (mods[key] ? gen(name, key) : "");
            }), "");
        }
        function createBEM(name) {
            return function(el, mods) {
                if (el && "string" !== typeof el) {
                    mods = el;
                    el = "";
                }
                el = el ? "".concat(name, "__").concat(el) : name;
                return "".concat(el).concat(gen(el, mods));
            };
        }
        function createNamespace(commonName, name) {
            name = "".concat(commonName, "-").concat(name);
            return createBEM(name);
        }
        var bem = createNamespace("product", "search");
        function getUrlWithSearch(keyword) {
            var currentUrl = window.location.href;
            var url = new URL(currentUrl);
            if (keyword) url.searchParams.set("keyword", keyword);
            return keyword ? "".concat(url.origin).concat(url.pathname, "?").concat(url.searchParams.toString()) : "".concat(url.origin).concat(url.pathname);
        }
        function popupSearch() {
            var $searchWrapper = __SL_$__("#JS-product-search-input");
            var base = new BaseClass["default"]("product:search:input", $searchWrapper);
            var $searchInput = $searchWrapper.find(".".concat(bem("input")));
            base.$on("click", ".".concat(bem("input")), (function(e) {
                __SL_$__(e.target).trigger("blur").val("");
                window.SL_EventBus.emit("stage-header-search", "open", "input");
            }));
            base.$on("click", ".".concat(bem("inputButton")), (function() {
                var keyword = $searchInput.val();
                var url = getUrlWithSearch(keyword.trim());
                window.location.href = url;
            }));
        }
        popupSearch();
    }
}, __webpack_require__ => {
    var __webpack_exec__ = moduleId => __webpack_require__(__webpack_require__.s = moduleId);
    __webpack_require__.O(0, [ "vendor" ], (() => __webpack_exec__("./src/assets/product/search/main.js")));
    __webpack_require__.O();
} ]);